# ADR-0027: Localization and Internationalization (i18n) Policy

## Status
Accepted

## Context
Tiffany is designed as a globally adoptable agentic development platform. As such, future-facing support for multiple languages, cultural formatting standards, and locale-aware experiences is essential.

While English will be the primary development and interaction language during early phases, we anticipate:

- Use in multilingual developer teams
- Interaction with non-English documentation and tool outputs
- User interfaces (CLI/UI) needing localized strings and number/date formatting
- Output generation (e.g., code comments, prompts) in user-preferred languages

---

## Decision

### üåç Internationalization Principles

- All user-facing text (UI strings, CLI output, error messages) must support locale substitution
- Locale-sensitive formatting (dates, decimals, currency, units) is standardized via i18n-aware libraries
- Agent output (e.g. LLM-generated summaries) should support optional `language: xx` configuration
- Language defaults are inferred via environment (`LANG`, `LC_ALL`) or explicitly via config

---

### üì¶ Technical Implementation

#### CLI/Daemon Interface

- CLI uses gettext-compatible message catalogs (`.po`, `.mo`)
- Environment-aware message loading (`LC_MESSAGES`, `LANG`)
- Fallback locale: `en_US`

#### Web Interface

- I18n JSON bundles using ICU MessageFormat
- Language selection dropdown or browser `Accept-Language` inference

#### Agent Runtime

- `AgentContext` includes `preferred_language` field (inferred or configured)
- All PAL and WAL logs retain `locale` of execution
- Skills with text output must receive `LanguageContext` for formatting/translation

---

### üß† LLM Interaction (Language-Aware)

- Prompts generated by the ReAct loop may include `language` hint (e.g., "Generate in German")
- Translated prompts and responses are streamed with language metadata
- Model fallback: English ‚Üí user's language translation ‚Üí post-processing (if LLM lacks native support)

---

### üß™ Developer Documentation and Tooling

- All developer documentation and CLI help commands support localization tags
- Contributors follow a `.locales/` structure:
  - `en_US/`, `fr_FR/`, `de_DE/`, etc.
- Locales are managed using `gettext`, `i18next`, or ICU tooling (TBD per frontend/backend component)

---

### ‚úÖ Locale-Aware Capabilities

| Capability                  | Implementation                         |
|-----------------------------|------------------------------------------|
| CLI help output             | gettext `.po` + locale parser            |
| Web UI text                 | ICU JSON bundle (via i18next)            |
| LLM code explanations       | Prompt templating with language hint     |
| Timestamps / durations      | locale-aware formatter (`chrono` crate)  |
| Currency / numeric values   | `num-format` or `intl_pluralrules`       |
| Logs                        | Include locale + language of origin      |

---

## Consequences

- Slight increase in complexity of CLI/UI toolchains and agent API surface
- Testing effort for multilingual output and encoding robustness
- Enables early support for accessibility, inclusivity, and global reach

---

## Related

- ADR-0031: Accessibility and Usability Guidelines
- ADR-0013: REST/gRPC API Design
- ADR-0015: Metrics and Instrumentation Plan
